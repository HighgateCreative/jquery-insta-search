/*
 *  jQuery Insta-Search - v0.1.0
 *  Add Google like instant searching to your search form.
 *  
 *
 *  Made by Sean Zellmer
 *  Under MIT License
 */
!function(a,b,c){function d(b,c){this.element=b,this.$element=a(b),this.settings=a.extend({},f,c),this._defaults=f,this._name=e,this.init()}var e="instaSearch",f={results:null,searchField:null};a[e]||(a[e]={}),a.extend(d.prototype,{init:function(){function d(c){a.ajax({type:"POST",url:"/xm_instance/insta_search.cgi",data:"rm=s&st="+c,success:function(a){this.results.html(a),this.results.css({display:"block",height:b.innerHeight-100+"px"}),this.$element.data("is_current",this.results.children("ul").find("li:not(.ignore)").eq(0)),this.$element.data("is_current").addClass("current"),this.$element.data("isIndex",0)}})}this.searchField=this.settings.searchField?a(this.settings.searchField):this.$element.find(":text"),this.results=this.settings.results&&this.$element.find(this.settings.results).length>0?this.$element.find(this.settings.results):a("div",{id:"searchResponse"}).appendTo(this.$element),this.searchField.keyup(this.keymapping),this.$element.submit(function(a){a.preventDefault(),""===this.searchField.val()?(this.results.html(""),this.results.css("display","none")):d(this.searchField.val())}),a(c).on("click",this.results.children("ul").children("li"),function(){b.location=a(this).attr("title")}),this.results.blur(function(){this.$element.data("clear_results",!0),b.setTimeout(function(){this.$element.data("clear_results")&&!this.searchField.is(":focus")&&(this.results.html(""),this.results.css("display","none"))},1e3)}),""===this.searchField.val()?(this.results.html(""),this.results.css("display","none")):d(this.searchField.val()),this.searchField.focus(function(){""===this.searchField.val()?(this.results.html(""),this.results.css("display","none")):d(this.searchField.val())}),this.results.click(function(){this.$element.data("clear_results",!1)}),this.results.css("width",this.searchField.width()),this.results.hover(function(){this.$element.data("clear_results",!1)},function(){this.$element.data("clear_results",!0),b.setTimeout(function(){this.$element.data("clear_results")&&!this.searchField.is(":focus")&&(this.results.html(""),this.results.css("display","none"))},1e3)})},keymapping:function(a){a.which<=40&&a.which>=37||9===a.which||a.which>=16&&a.which<=19||20===a.which||27===a.which||93===a.which||91===a.which||13===a.which?40===a.which?(this.$element.data("is_current")&&this.$element.data("is_current").length>0?(this.$element.data("isIndex")===this.results.children("ul").find("li:not(.ignore)").length-1?this.$element.data("isIndex",0):this.$element.data("isIndex",this.$element.data("isIndex")+1),this.$element.data("is_current").removeClass("current"),this.$element.data("is_current",this.results.children("ul").find("li:not(.ignore)").eq(this.$element.data("isIndex"))),this.$element.data("is_current").addClass("current")):(this.$element.data("is_current",this.results.children("ul").find("li:not(.ignore)").eq(0)),this.$element.data("is_current").addClass("current"),this.$element.data("isIndex",0)),a.preventDefault()):38===a.which?(this.$element.data("is_current")&&this.$element.data("is_current").length>0?(0===this.$element.data("isIndex")?this.$element.data("isIndex",this.results.children("ul").find("li:not(.ignore)").length-1):this.$element.data("isIndex",this.$element.data("isIndex")-1),this.$element.data("is_current").removeClass("current"),this.$element.data("is_current",this.results.children("ul").find("li:not(.ignore)").eq(this.$element.data("isIndex"))),this.$element.data("is_current").addClass("current")):(this.$element.data("is_current",this.results.children("ul").find("li:not(.ignore)").eq(0)),this.$element.data("is_current").addClass("current"),this.$element.data("isIndex",0)),a.preventDefault()):13===a.which&&this.$element.data("is_current")&&this.$element.data("is_current").length>0&&(b.location=this.$element.data("is_current").attr("title")):""===this.searchField.val()?(this.results.html(""),this.results.css("display","none")):get_results(this.searchField.val())}}),a.fn[e]=function(b){return this.each(function(){a.data(this,"plugin_"+e)||a.data(this,"plugin_"+e,new d(this,b))}),this}}(jQuery,window,document);