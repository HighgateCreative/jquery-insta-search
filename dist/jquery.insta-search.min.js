/*
 *  jQuery Insta-Search - v0.1.0
 *  Add Google like instant searching to your search form.
 *  
 *
 *  Made by Sean Zellmer
 *  Under MIT License
 */
!function(a,b,c){function d(b,c){this.element=b,this.$element=a(b),this.settings=a.extend({},f,c),this._defaults=f,this._name=e,this.init()}var e="instaSearch",f={ajaxParams:{},url:"",results:null,searchField:null,debug:!1};a[e]||(a[e]={}),a.extend(d.prototype,{init:function(){var d=this;d.searchField=d.settings.searchField?a(d.settings.searchField):d.$element.find(":text"),d.results=d.settings.results&&d.$element.find(d.settings.results).length>0?d.$element.find(d.settings.results):a("<div>",{id:"searchResponse"}).appendTo(d.$element),""===d.results.attr("id")&&d.results.attr("id","searchResponse"),d.searchField.keyup(d.keymapping()),d.$element.submit(function(a){a.preventDefault(),""===d.searchField.val()?(d.results.html(""),d.results.css("display","none")):d.get_results(d.searchField.val())}),a(c).on("click",d.results.attr("id")+" > ul > li",function(){b.location=a(this).attr("title")}),d.results.click(function(){d.$element.data("clear_results",!1)}),d.results.hover(function(){d.$element.data("clear_results",!1)},function(){d.settings.debug||d.$element.data("clear_results",!0),b.setTimeout(function(){d.$element.data("clear_results")&&!d.searchField.is(":focus")&&(d.results.html(""),d.results.css("display","none"))},1e3)}),""===d.searchField.val()?(d.results.html(""),d.results.css("display","none")):d.get_results(d.searchField.val()),d.results.css("width",d.searchField.width()),d.searchField.focus(function(){""===d.searchField.val()?(d.results.html(""),d.results.css("display","none")):d.get_results(d.searchField.val())}),d.searchField.blur(function(){d.settings.debug||d.$element.data("clear_results",!0),b.setTimeout(function(){d.$element.data("clear_results")&&!d.searchField.is(":focus")&&(d.results.html(""),d.results.css("display","none"))},1e3)})},get_results:function(b){var d=this,e={st:b},f=a.extend({},this.settings.ajaxParams,e);a.ajax({type:"POST",url:d.settings.url,data:f,success:function(b){d.results.html(b),d.results.css({display:"block",height:a(c).innerHeight()-(d.searchField.offset().top+d.searchField.outerHeight(!0))-100+"px"}),d.$element.data("is_current",d.results.children("ul").find("li:not(.ignore)").eq(0)),d.$element.data("is_current").addClass("current"),d.$element.data("isIndex",0)}})},keymapping:function(){var a=this;return function(c){c.which<=40&&c.which>=37||9===c.which||c.which>=16&&c.which<=19||20===c.which||27===c.which||93===c.which||91===c.which||13===c.which?40===c.which?(a.$element.data("is_current")&&a.$element.data("is_current").length>0?(a.$element.data("isIndex")===a.results.children("ul").find("li:not(.ignore)").length-1?a.$element.data("isIndex",0):a.$element.data("isIndex",a.$element.data("isIndex")+1),a.$element.data("is_current").removeClass("current"),a.$element.data("is_current",a.results.children("ul").find("li:not(.ignore)").eq(a.$element.data("isIndex"))),a.$element.data("is_current").addClass("current")):(a.$element.data("is_current",a.results.children("ul").find("li:not(.ignore)").eq(0)),a.$element.data("is_current").addClass("current"),a.$element.data("isIndex",0)),c.preventDefault()):38===c.which?(a.$element.data("is_current")&&a.$element.data("is_current").length>0?(0===a.$element.data("isIndex")?a.$element.data("isIndex",a.results.children("ul").find("li:not(.ignore)").length-1):a.$element.data("isIndex",a.$element.data("isIndex")-1),a.$element.data("is_current").removeClass("current"),a.$element.data("is_current",a.results.children("ul").find("li:not(.ignore)").eq(a.$element.data("isIndex"))),a.$element.data("is_current").addClass("current")):(a.$element.data("is_current",a.results.children("ul").find("li:not(.ignore)").eq(0)),a.$element.data("is_current").addClass("current"),a.$element.data("isIndex",0)),c.preventDefault()):13===c.which&&a.$element.data("is_current")&&a.$element.data("is_current").length>0&&(b.location=a.$element.data("is_current").attr("title")):""===a.searchField.val()?(a.results.html(""),a.results.css("display","none")):a.get_results(a.searchField.val())}}}),a.fn[e]=function(b){return this.each(function(){a.data(this,"plugin_"+e)||a.data(this,"plugin_"+e,new d(this,b))}),this}}(jQuery,window,document);