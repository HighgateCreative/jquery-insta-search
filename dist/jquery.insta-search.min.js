/*
 *  jQuery Insta-Search - v0.1.0
 *  Add Google like instant searching to your search form.
 *  
 *
 *  Made by Sean Zellmer
 *  Under MIT License
 */
!function(a,b,c){function d(b,c){this.element=b,this.$element=a(b),this.settings=a.extend({},f,c),this._defaults=f,this._name=e,this.init()}var e="instaSearch",f={results:null,searchField:null};a[e]||(a[e]={}),a.extend(d.prototype,{init:function(){function d(c){a.ajax({type:"POST",url:"/xm_instance/insta_search.cgi",data:"rm=s&st="+c,success:function(a){e.results.html(a),e.results.css({display:"block",height:b.innerHeight-100+"px"}),e.$element.data("is_current",e.results.children("ul").find("li:not(.ignore)").eq(0)),e.$element.data("is_current").addClass("current"),e.$element.data("isIndex",0)}})}var e=this;e.searchField=e.settings.searchField?a(e.settings.searchField):e.$element.find(":text"),e.results=e.settings.results&&e.$element.find(e.settings.results).length>0?e.$element.find(e.settings.results):a("div",{id:"searchResponse"}).appendTo(e.$element),""===e.results.attr("id")&&e.results.attr("id","searchResponse"),e.searchField.keyup(e.keymapping()),e.$element.submit(function(a){a.preventDefault(),""===e.searchField.val()?(e.results.html(""),e.results.css("display","none")):d(e.searchField.val())}),a(c).on("click",e.results.attr("id")+" > ul > li",function(){b.location=a(this).attr("title")}),e.results.blur(function(){e.$element.data("clear_results",!0),b.setTimeout(function(){e.$element.data("clear_results")&&!e.searchField.is(":focus")&&(e.results.html(""),e.results.css("display","none"))},1e3)}),""===e.searchField.val()?(e.results.html(""),e.results.css("display","none")):d(e.searchField.val()),e.searchField.focus(function(){""===e.searchField.val()?(e.results.html(""),e.results.css("display","none")):d(e.searchField.val())}),e.results.click(function(){e.$element.data("clear_results",!1)}),e.results.css("width",e.searchField.width()),e.results.hover(function(){e.$element.data("clear_results",!1)},function(){e.$element.data("clear_results",!0),b.setTimeout(function(){e.$element.data("clear_results")&&!e.searchField.is(":focus")&&(e.results.html(""),e.results.css("display","none"))},1e3)})},keymapping:function(){var a=this;return function(c){c.which<=40&&c.which>=37||9===c.which||c.which>=16&&c.which<=19||20===c.which||27===c.which||93===c.which||91===c.which||13===c.which?40===c.which?(a.$element.data("is_current")&&a.$element.data("is_current").length>0?(a.$element.data("isIndex")===a.results.children("ul").find("li:not(.ignore)").length-1?a.$element.data("isIndex",0):a.$element.data("isIndex",a.$element.data("isIndex")+1),a.$element.data("is_current").removeClass("current"),a.$element.data("is_current",a.results.children("ul").find("li:not(.ignore)").eq(a.$element.data("isIndex"))),a.$element.data("is_current").addClass("current")):(a.$element.data("is_current",a.results.children("ul").find("li:not(.ignore)").eq(0)),a.$element.data("is_current").addClass("current"),a.$element.data("isIndex",0)),c.preventDefault()):38===c.which?(a.$element.data("is_current")&&a.$element.data("is_current").length>0?(0===a.$element.data("isIndex")?a.$element.data("isIndex",a.results.children("ul").find("li:not(.ignore)").length-1):a.$element.data("isIndex",a.$element.data("isIndex")-1),a.$element.data("is_current").removeClass("current"),a.$element.data("is_current",a.results.children("ul").find("li:not(.ignore)").eq(a.$element.data("isIndex"))),a.$element.data("is_current").addClass("current")):(a.$element.data("is_current",a.results.children("ul").find("li:not(.ignore)").eq(0)),a.$element.data("is_current").addClass("current"),a.$element.data("isIndex",0)),c.preventDefault()):13===c.which&&a.$element.data("is_current")&&a.$element.data("is_current").length>0&&(b.location=a.$element.data("is_current").attr("title")):""===a.searchField.val()?(a.results.html(""),a.results.css("display","none")):get_results(a.searchField.val())}}}),a.fn[e]=function(b){return this.each(function(){a.data(this,"plugin_"+e)||a.data(this,"plugin_"+e,new d(this,b))}),this}}(jQuery,window,document);